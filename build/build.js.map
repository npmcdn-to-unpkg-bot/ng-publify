{"version":3,"sources":["node_modules/browser-pack/_prelude.js","client/website/scripts/app_boot.js","client/website/scripts/classes/page.class.js","client/website/scripts/components/editable.directive.js","client/website/scripts/components/toolbox.component.js"],"names":[],"mappings":"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","file":"build.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","import ngpToolbox from './components/toolbox.component.js';\nimport ngpEditable from './components/editable.directive.js';\nimport Page from './classes/page.class.js';\n\n(function(app) {\n    app.serverUrl = \"localhost:3000\";\n    \n    app.NONE = 0; app.HTTP_ONLY = 1; app.WEBSOCKET_PREFER = 2; app.WEBSOCKET_ONLY = 3;\n    \n    app.useSecureConnecion = false;\n    app.dataConnectionErrorMessage = \"Dataserver error\";\n    \n    \n    app.webSocket = {\n        ws: new WebSocket('ws://' + app.serverUrl + '/'),\n        send: function(cmd, data) {\n            app.webSocket.ws.send(cmd + ':' + JSON.stringify(data));\n        },\n        get: function(path, callback) {\n            app.webSocket.ws.send('CONTENT:' + path);\n            app.webSocket.ws.onmessage = function(event) {\n                callback(event.data);\n            }\n        }\n    }\n\n    app.http = {\n        get: function(path, callback) {\n            callback({ data: 123 })\n        }\n    }\n    \n    app.AppComponent = ng.core.Component({\n        selector: 'my-app',\n        templateUrl: 'templates/pagetypes/frontpage.html',\n        directives: [ngpToolbox, ngpEditable]\n    }).Class({\n        constructor: function() {\n            // These settings should be fetched from the user's usergroup on load, editors will normally use WebSockets while endusers will use HTTP.\n            app.editorConnectionMode = app.HTTP_ONLY;  // Users will setup a WebSocket connection to the data-server instead of using HTTP requests if possible.\n            \n            app.contentCacheEnabled = true; // This defaults to true. False means we will not cache data we fetch, should rarely be disabled.\n            app.contentCacheLocalStorageMs = 1000 * 60 * 60 * 24 * 3;   // [-1] Store cache over browser sessions?\n        },\n        ngOnInit: function() {\n            // Initial population            \n            var xhttp = new XMLHttpRequest();\n            xhttp.onreadystatechange = function() {\n                if (xhttp.readyState == 4 && xhttp.status == 200) {\n                    app.page = JSON.parse(xhttp.responseText);\n                    //app.page.prototype = Page.prototype;\n                    //app.page.Populate();\n                    \n                    (function populateData(data, el) {\n                        for(var editableId in data.editables) {\n                            el.querySelector('[editable=\"' + editableId + '\"]').innerHTML = data.editables[editableId];\n                        }\n\n                        for(var moduleId in data.modules) {\n                            \n                        }\n\n                        for(var containerId in data.containers) {\n                            var containerEl = el.querySelector('[container=\"' + containerId + '\"]');\n                            if(containerEl) {\n                                populateData(data.containers[containerId], containerEl);\n                            }\n                        }\n                    })(app.page, document.documentElement);\n                } else if(xhttp.readyState == 4) {\n                    console.error(xhttp);\n                    document.clear();\n                    document.write(app.dataConnectionErrorMessage);\n                }\n            };\n            xhttp.open(\"GET\", 'http' + (app.useSecureConnecion ? 's' : '') + '://' + app.serverUrl + '/content/getPage/' + ~~(1000000*Math.random()), true);\n            xhttp.send();\n            \n        }\n    });\n\n    document.addEventListener('DOMContentLoaded', function() {\n        ng.platformBrowserDynamic.bootstrap(app.AppComponent);\n    });\n    \n\n    // Move to own file:\n    document.addEventListener('DOMContentLoaded', function() {\n        app.activeElement = null;\n\n        app.startEdit = function() {\n            document.body.classList.add('publify--is-editing');\n            Array.prototype.forEach.call(document.querySelectorAll('[editable]'), function(el) {\n                el.contentEditable = true;\n                el.addEventListener('focus', function(e) {\n                   app.activeElement = e.target;\n                });\n                el.addEventListener('blur', function(e) {\n                    e.preventDefault();\n                });\n            });\n\n            document.body.classList.add('publify-editing');\n        };\n        app.endEdit = function() {\n            document.body.classList.remove('publify--is-editing');\n            Array.prototype.forEach.call(document.querySelectorAll('[editable]'), function(el) {\n                el.contentEditable = false;\n            });\n            document.body.classList.remove('publify-editing');\n        };\n\n        //publify.startEdit();\n    });\n\n})(window.app || (window.app = {}));","export class Page {\r\n    constructor(id) {\r\n        this.id = id;\r\n    }\r\n    children(callback) {\r\n        app.content.getChildrenOfPage(this)\r\n    }\r\n}","\nexport default ng.core.Directive({\n    selector: '[editable]',\n    host: {\n        '(input)': 'emit($event)',\n        '(focus)': 'emitStart($event)'\n    },\n    inputs: ['counterValue:init']\n}).Class({\n    constructor: function() {\n        this.emitter = new ng.core.EventEmitter();\n\n    },\n    ngAfterViewInit: function() {\n        console.log(this);\n    },\n    emitStart: function($event) {\n        var container = (function getContainer(el) {\n            if(el.parentElement) {\n                if(el.parentElement.getAttribute('container')) {\n                    return el.parentElement;\n                } else {\n                    return getContainer(el.parentElement);\n                }\n            } else return document.body;\n        })($event.srcElement);\n\n        app.webSocket.send('EDIT_START', {\n            containerId: container.getAttribute('container'),\n            editableId: $event.srcElement.getAttribute('editable')\n        });\n    },\n    emit: function($event) {\n        var container = (function getContainer(el) {\n            if(el.parentElement) {\n                if(el.parentElement.getAttribute('container')) {\n                    return el.parentElement;\n                } else {\n                    return getContainer(el.parentElement);\n                }\n            } else return document.body;\n        })($event.srcElement);\n\n        app.webSocket.send('EDIT',\n            $event.srcElement.innerHTML\n        );\n\n        $event.srcElement;\n\n        this.emitter.emit('This is some value from children');\n    }\n});","// Keep checking\nfunction updateTools() {\n    if(document.getSelection().rangeCount) {\n        // Font color\n        document.querySelector('.tool--font-color').style.borderBottomColor = document.defaultView.getComputedStyle(document.getSelection().getRangeAt(0).commonAncestorContainer.parentNode, null).getPropertyValue('color')\n\n        // Font bold\n        if(document.defaultView.getComputedStyle(document.getSelection().getRangeAt(0).commonAncestorContainer.parentNode, null).getPropertyValue('font-weight') === 'bold') {\n            document.querySelector('.tool--font-bold').classList.add('active');\n        } else {\n            document.querySelector('.tool--font-bold').classList.remove('active');\n        }\n    }\n}\n\nwindow.addEventListener('click', updateTools);\nwindow.addEventListener('keyup', updateTools);\n\nexport default ng.core.Component({\n    selector: 'ngp-toolbox',\n    templateUrl: '/client/ng-publify/templates/toolbox.html'\n}).Class({\n    constructor: function() {\n        \n    }\n});\n"]}